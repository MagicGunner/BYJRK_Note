<Window
    x:Class="ListBoxDemo.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:ListBoxDemo"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
    Title="MainWindow"
    Width="800"
    Height="450"
    d:DataContext="{d:DesignInstance local:MainWindowViewModel,
                                     IsDesignTimeCreatable=True}"
    mc:Ignorable="d">

    <TabControl>
        <TabItem Header="全选功能2">
            <DockPanel Margin="5">
                <StackPanel
                    Margin="0,5,0,0"
                    DockPanel.Dock="Bottom"
                    Orientation="Horizontal">
                    <Button Width="120" Content="Select ALl" Command="ApplicationCommands.SelectAll"
                            CommandTarget="{Binding ElementName=ListBox3}">
                    </Button>
                    <Button
                        Width="120"
                        Click="ButtonBase_OnClick"
                        Content="Check Index" />
                    <Button
                        Margin="5,0,0,0"
                        Command="{Binding SelectStudentCommand}"
                        CommandParameter="Peter"
                        Content="Select" />
                </StackPanel>
                <ListBox
                    x:Name="ListBox3"
                    DisplayMemberPath="FullName"
                    ItemsSource="{Binding Students}"
                    SelectedValue="{Binding SelectedName}"
                    SelectedValuePath="FullName"
                    SelectionMode="Extended">
                    <ListBox.CommandBindings>
                        <CommandBinding Command="ApplicationCommands.SelectAll" Executed="CommandBinding_OnExecuted"></CommandBinding>
                    </ListBox.CommandBindings>
                </ListBox>
            </DockPanel>
        </TabItem>

        <TabItem Header="全选功能1">
            <DockPanel Margin="5">
                <StackPanel
                    Margin="0,5,0,0"
                    DockPanel.Dock="Bottom"
                    Orientation="Horizontal">
                    <Button Width="120" Content="Select ALl">
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="Click">
                                <i:CallMethodAction TargetObject="{Binding ElementName=ListBox2}"
                                                    MethodName="SelectAll">
                                </i:CallMethodAction>
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                    </Button>
                    <Button
                        Width="120"
                        Click="ButtonBase_OnClick"
                        Content="Check Index" />
                    <Button
                        Margin="5,0,0,0"
                        Command="{Binding SelectStudentCommand}"
                        CommandParameter="Peter"
                        Content="Select" />
                </StackPanel>
                <ListBox
                    x:Name="ListBox2"
                    DisplayMemberPath="FullName"
                    ItemsSource="{Binding Students}"
                    SelectedValue="{Binding SelectedName}"
                    SelectedValuePath="FullName"
                    SelectionMode="Extended">
                </ListBox>
            </DockPanel>
        </TabItem>

        <TabItem Header="属性和功能">
            <DockPanel Margin="5">
                <StackPanel
                    Margin="0,5,0,0"
                    DockPanel.Dock="Bottom"
                    Orientation="Horizontal">
                    <Button Width="120" Content="Select ALl" />
                    <Button
                        Width="120"
                        Click="ButtonBase_OnClick"
                        Content="Check Index" />
                    <Button
                        Margin="5,0,0,0"
                        Command="{Binding SelectStudentCommand}"
                        CommandParameter="Peter"
                        Content="Select" />
                </StackPanel>
                <ListBox
                    x:Name="ListBox"
                    DisplayMemberPath="FullName"
                    ItemsSource="{Binding Students}"
                    SelectedValue="{Binding SelectedName}"
                    SelectedValuePath="FullName"
                    SelectionMode="Extended">
                    <ListBox.Style>
                        <Style TargetType="ListBox">
                            <!-- 初始状态 -->
                            <Setter Property="BorderThickness" Value="2" />
                            <Setter Property="BorderBrush" Value="Gray" />
                            <Setter Property="Background" Value="White" />

                            <Style.Triggers>
                                <EventTrigger RoutedEvent="SelectionChanged">
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <!-- 边框变红 -->
                                            <ColorAnimation
                                                Storyboard.TargetProperty="(Border.BorderBrush).(SolidColorBrush.Color)"
                                                To="Red"
                                                Duration="0:0:0.1" />

                                            <!-- 背景变色 -->
                                            <ColorAnimation
                                                Storyboard.TargetProperty="(Panel.Background).(SolidColorBrush.Color)"
                                                To="#FFFFF3C0"
                                                Duration="0:0:0.1" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                            </Style.Triggers>

                        </Style>
                    </ListBox.Style>
                </ListBox>
            </DockPanel>
        </TabItem>


    </TabControl>


</Window>